# Ассистент по разметке текста с использованием FLAN, ML модели и GPT-3.5

## О проекте

Этот проект — веб-приложение на Streamlit, которое помогает быстро и удобно разметить тексты для задач классификации. В приложении реализованы три способа разметки:

- **FLAN (локальная бинарная классификация)** — быстрый локальный метод для пометки текста.
- **ML модель (загружаемая модель sklearn)** — позволяет оценить предсказания на собственных данных с метками.
- **GPT-3.5 через OpenAI API** — экспериментальная разметка текста с использованием мощной языковой модели OpenAI.

Приложение поддерживает как разметку отдельного текста, так и пакетную разметку через загрузку CSV файлов с колонкой `text`. Для ML модели обязательно наличие колонки `label` для оценки качества.

---

## Функциональность

- Ввод текста для моментальной разметки.
- Загрузка CSV с текстами для пакетной разметки.
- Отчёт по классификации (precision, recall, f1-score) для ML модели.
- Использование GPT-3.5 с возможностью задать свой API ключ через интерфейс.
- Скачивание размеченных данных в формате CSV.

---

## Установка и запуск

1. Клонируйте репозиторий:
    ```bash
    git clone https://github.com/yourusername/text-labeling-assistant.git
    cd text-labeling-assistant
    ```

2. Создайте и активируйте виртуальное окружение (рекомендуется):
    ```bash
    python -m venv venv
    source venv/bin/activate  # Linux/Mac
    venv\Scripts\activate     # Windows
    ```

3. Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

4. Для работы с GPT-3.5 получите API ключ OpenAI и добавьте его в `.env` файл в корне проекта:
    ```
    OPENAI_API_KEY=your_openai_api_key_here
    ```

5. Запустите приложение:
    ```bash
    streamlit run app.py
    ```

6. Откройте в браузере страницу, обычно это [http://localhost:8501](http://localhost:8501)

---

## Использование

- Выберите метод разметки в верхнем радиобоксе.
- Для FLAN и GPT доступны как единичная, так и пакетная разметка (через загрузку CSV с колонкой `text`).
- Для ML модели загрузите CSV с колонками `text` и `label` для оценки качества.
- В случае GPT-3.5 введите API ключ в специальное поле (можно использовать ключ из `.env`).
- После пакетной разметки скачайте CSV с добавленными метками.

---

## Требования

- Python 3.8+
- Библиотеки из `requirements.txt`:
  - streamlit
  - pandas
  - scikit-learn
  - joblib
  - openai (или openai-python, если используете официальный клиент)
  - python-dotenv

---

## Структура проекта

## Структура проекта

```
├── ml_flan_gpt_app.py       # Основной Streamlit интерфейс
├── gpt_api.py               # Работа с GPT-3.5 API
├── local_flant5.py          # Локальная функция разметки FLAN
├── sentiment_classifier.pkl # Предобученная ML модель
├── requirements.txt         # Список зависимостей
├── .env                     # Файл с переменными окружения (API ключи)
└── README.md                # Описание проекта
```
---

## Важные замечания

- Для корректной работы GPT-3.5 требуется OpenAI API ключ.
- Локальная модель FLAN — пример бинарной классификации, может требовать доработки под ваши задачи.
- ML модель — это пример, вы можете заменить её на свою собственную.
- Пакетная разметка может занимать время в зависимости от размера файла и выбранного метода.
